// the path to pdflatexvar pdflatexexe="/usr/texbin/pdflatex";// the temp folder where scripts will be stored and executedvar temppath="";// the name of the terminal filevar termfname="latex2illustrator";// delay function found here http://www.wer-weiss-was.de/theme157/article1143593.html  function delay(prmSec){  prmSec *= 1000;  var eDate = null;  var eMsec = 0;  var sDate = new Date();  var sMsec = sDate.getTime();  do {  eDate = new Date();  eMsec = eDate.getTime();  } while ((eMsec-sMsec)<prmSec);  }/** * creates a .terminal file * @param  {String} term_file_name --> the name for the .term file * @param  {String} pdflatexexe --> the path to pdflatex * @param  {String} temppath --> the path to the script * @return {File}                the created termfile */function createTermFile(term_file_name, pdflatexexe, temppath) {  var termfile = new File(temppath + "/" + term_file_name + ".terminal");  termfile.open("w");  termfile.writeln(      "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +      "<!DOCTYPE plist PUBLIC \"-//Apple Computer//DTD PLIST 1.0//EN\"" +      "\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n" +      "<plist version=\"1.0\">\n" +      "<dict>\n" +        "<key>CommandString</key>\n" +        "<string>" + pdflatexexe + " -aux-directory=\"" + temppath +          "\" -include-directory=\"" + temppath +          "\" -output-directory=\"" +temppath+"\" \"" + temppath + "/latex2illustrator.tex\"" +        "; exit 0</string>\n" +        "<key>RunCommandAsShell</key>\n" +        "<false/>\n" +        "<key>name</key>\n" +        "<string>LaTeX2Illustrator</string>\n"+        "<key>shellExitAction</key>\n" +        "<integer>1</integer>\n" +        "<key>type</key>\n"+        "<string>Window Settings</string>\n"+      "</dict>\n"+      "</plist>\n");  termfile.close();  return termfile;};// remember the last user input in a text filevar lastcode="$$$$"var lastcodefile=File(temppath+"/latex2illustrator_lastcode.txt");if(lastcodefile.exists)  {  lastcodefile.open("r");  lastcode=lastcodefile.read();  lastcodefile.close();  }// prompt for user inputvar fontsize = 11;var latexcode=prompt("Please enter LaTeX code",lastcode,"LaTeX");if(latexcode!=null){  lastcodefile.open("w");  lastcodefile.write(latexcode);  lastcodefile.close();  // add latex header etc. to create a complete latex document  var latexfile=new File(temppath+'/latex2illustrator.tex');  latexfile.open("w");  latexfile.writeln("\\documentclass[" + fontsize + "pt]{article}");  // add or remove additional latex packages here  latexfile.writeln("\\usepackage{amsmath}");  latexfile.writeln("\\usepackage{amssymb}");  latexfile.writeln("\\usepackage{gensymb}");   // for \degree  latexfile.writeln("\\usepackage{textcomp}");  // for \textdegree  latexfile.writeln("\\usepackage{bm}");        // bold math  latexfile.writeln("\\begin{document}");  latexfile.writeln("\\pagestyle{empty}"); // no page number  latexfile.writeln(latexcode);  latexfile.writeln("\\end{document}");  latexfile.close();  var pdffile=File(temppath+"/latex2illustrator.pdf");  if(pdffile.exists){    pdffile.remove();}  // Create new term file to execute the code  var new_termfile = createTermFile(termfname, pdflatexexe, temppath);  new_termfile.execute(); // now execute the termfile  var pdffile=File(temppath+"/latex2illustrator.pdf");  delay(3);  if(pdffile.exists)    {    // import pdf file into the current document    var grp=app.activeDocument.activeLayer.groupItems.createFromFile(pdffile);    // The imported objects are grouped twice. Now move the subgroup    // items to the main group and skip the page frame (i>0 condition)    for( var i=grp.pageItems[0].pageItems.length-1; i>0; i--){        grp.pageItems[0].pageItems[i].move(grp,ElementPlacement.PLACEATEND);    }    grp.pageItems[0].remove();    // Move the imported objects to the center of the current view.    grp.translate(app.activeDocument.activeView.centerPoint[0]-grp.left, app.activeDocument.activeView.centerPoint[1]-grp.top);    }   else{     alert("File "+temppath+"/"+pdffile.name+" could not be created. LaTeX error?");  }}